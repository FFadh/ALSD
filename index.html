<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Stream Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <h1>Live Stream Performance</h1>

    <div class="dashboard">
        <div class="stats">
            <p>Total GMV: <span id="totalGMV">Loading...</span></p>
            <p>Total Hours: <span id="totalHours">Loading...</span></p>
            <p>Total Order: <span id="totalOrder">Loading...</span></p>
        </div>

        <div class="top-host">
            <h2>Top Host</h2>
            <img id="topHostImage" src="" alt="Host Image">
            <p id="topHost">Loading...</p>
        </div>

        <div class="client">
            <h2>Client</h2>
            <p id="client">Loading...</p>
        </div>

        <div class="video">
            <h2>Live Stream Video</h2>
            <iframe id="videoFrame" width="560" height="315"></iframe>
        </div>

        <div class="photo-frame">
            <h2>Photo Frame</h2>
            <img id="photoFrame" src="" alt="Photo Frame">
        </div>
    </div>

    <script>
        const sheetAPI = "PASTE_URL_APPS_SCRIPT_HERE";

        function fetchData() {
            fetch(sheetAPI)
                .then(response => response.json())
                .then(data => {
                    document.getElementById("totalGMV").textContent = data.totalGMV;
                    document.getElementById("totalHours").textContent = data.totalHours;
                    document.getElementById("totalOrder").textContent = data.totalOrder;
                    document.getElementById("topHost").textContent = data.topHost;
                    document.getElementById("topHostImage").src = data.topHostImage;
                    document.getElementById("client").textContent = data.client;

                    // Format Google Drive Video Link
                    const videoId = data.videoLink.split("id=")[1];
                    document.getElementById("videoFrame").src = `https://drive.google.com/file/d/${videoId}/preview`;

                    // Update Photo Frame
                    document.getElementById("photoFrame").src = data.photoFrame;
                })
                .catch(error => console.error("Error fetching data:", error));
        }

        // Fetch data setiap 1 jam (3600000 ms)
        fetchData();
        setInterval(fetchData, 3600000);
    </script>

</body>
</html>
